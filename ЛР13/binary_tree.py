# –î–í–û–ò–ß–ù–û–ï –î–ï–†–ï–í–û –ü–û–ò–°–ö–ê (Binary Search Tree)
# –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è: –∫–∞–∂–¥—ã–π —É–∑–µ–ª –∏–º–µ–µ—Ç –º–∞–∫—Å–∏–º—É–º 2 —Ä–µ–±—ë–Ω–∫–∞
# –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –≤—Å—ë —á—Ç–æ —Å–ª–µ–≤–∞ < —Ä–æ–¥–∏—Ç–µ–ª—å < –≤—Å—ë —á—Ç–æ —Å–ø—Ä–∞–≤–∞
# –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã - O(log n)

def create_node(value):
    """
    –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π —É–∑–µ–ª –¥–µ—Ä–µ–≤–∞
    –ü–æ —Å—É—Ç–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–∞—Ä—å —Å —Ç—Ä–µ–º—è –ø–æ–ª—è–º–∏
    """
    return {
        'value': value,    # —Å–∞–º–æ –∑–Ω–∞—á–µ–Ω–∏–µ
        'left': None,      # –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–º–µ–Ω—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
        'right': None      # –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
    }


def insert(root, value):
    """
    –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –¥–µ—Ä–µ–≤–æ
    –†–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ - –∏–¥—ë–º –≤–Ω–∏–∑ –ø–æ –¥–µ—Ä–µ–≤—É –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë–º –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ
    """
    # –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π: –µ—Å–ª–∏ –¥–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ, —Å–æ–∑–¥–∞—ë–º –ø–µ—Ä–≤—ã–π —É–∑–µ–ª (–∫–æ—Ä–µ–Ω—å)
    if root is None:
        return create_node(value)
    
    # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –∏—â–µ–º –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
    if value < root['value']:
        # –ï—Å–ª–∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ - –∏–¥—ë–º –≤ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        root['left'] = insert(root['left'], value)
    elif value > root['value']:
        # –ï—Å–ª–∏ –±–æ–ª—å—à–µ - –∏–¥—ë–º –≤ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        root['right'] = insert(root['right'], value)
    else:
        # –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å - –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
        print(f"–ó–Ω–∞—á–µ–Ω–∏–µ {value} —É–∂–µ –µ—Å—Ç—å –≤ –¥–µ—Ä–µ–≤–µ")
    
    return root


def find_min(node):
    """
    –ò—â–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –¥–µ—Ä–µ–≤–µ
    –õ–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞—è: –º–∏–Ω–∏–º—É–º –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–∞–º–æ–º –ª–µ–≤–æ–º —É–∑–ª–µ
    """
    current = node
    # –ü—Ä–æ—Å—Ç–æ –∏–¥—ë–º –≤–ª–µ–≤–æ –ø–æ–∫–∞ –º–æ–∂–µ–º
    while current['left'] is not None:
        current = current['left']
    return current


def delete(root, value):
    """
    –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –¥–µ—Ä–µ–≤–∞ - —Å–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è!
    –ù—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å 3 —Ä–∞–∑–Ω—ã—Ö —Å–ª—É—á–∞—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–µ—Ç–µ–π —É —É–∑–ª–∞
    """
    # –ï—Å–ª–∏ –¥–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ - —É–¥–∞–ª—è—Ç—å –Ω–µ—á–µ–≥–æ
    if root is None:
        print(f"–ó–Ω–∞—á–µ–Ω–∏–µ {value} –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")
        return None

    # –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    if value < root['value']:
        # –ò—â–µ–º –≤ –ª–µ–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ
        root['left'] = delete(root['left'], value)
    elif value > root['value']:
        # –ò—â–µ–º –≤ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ
        root['right'] = delete(root['right'], value)
    else:
        # –ù–∞—à–ª–∏! –¢–µ–ø–µ—Ä—å —É–¥–∞–ª—è–µ–º —Å —É—á—ë—Ç–æ–º 3 —Å–ª—É—á–∞–µ–≤
        print(f"–£–¥–∞–ª—è–µ–º {value}")
        
        # –°–õ–£–ß–ê–ô 1: –£–∑–µ–ª –±–µ–∑ –¥–µ—Ç–µ–π (–ª–∏—Å—Ç) - –ø—Ä–æ—Å—Ç–æ —É–±–∏—Ä–∞–µ–º
        if root['left'] is None and root['right'] is None:
            return None
        
        # –°–õ–£–ß–ê–ô 2: –£–∑–µ–ª —Å –æ–¥–Ω–∏–º —Ä–µ–±—ë–Ω–∫–æ–º - –∑–∞–º–µ–Ω—è–µ–º —É–∑–µ–ª –µ–≥–æ —Ä–µ–±—ë–Ω–∫–æ–º
        if root['left'] is None:
            return root['right']  # –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤—ã–π
        if root['right'] is None:
            return root['left']   # –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ª–µ–≤—ã–π
        
        # –°–õ–£–ß–ê–ô 3: –£–∑–µ–ª —Å –¥–≤—É–º—è –¥–µ—Ç—å–º–∏ - —Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π!
        # –ù–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º—É–º –≤ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ (—ç—Ç–æ –±—É–¥–µ—Ç –ø—Ä–µ–µ–º–Ω–∏–∫)
        min_node = find_min(root['right'])
        # –ö–æ–ø–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–µ–µ–º–Ω–∏–∫–∞ –Ω–∞ –º–µ—Å—Ç–æ —É–¥–∞–ª—è–µ–º–æ–≥–æ
        root['value'] = min_node['value']
        # –£–¥–∞–ª—è–µ–º –ø—Ä–µ–µ–º–Ω–∏–∫–∞ –∏–∑ –ø—Ä–∞–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞
        root['right'] = delete(root['right'], min_node['value'])
    
    return root


# ============== –ü–û–ò–°–ö –í –ì–õ–£–ë–ò–ù–£ (DFS - Depth First Search) ==============
# DFS –∏–¥—ë—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–ª—É–±–æ–∫–æ –ø–æ –æ–¥–Ω–æ–π –≤–µ—Ç–∫–µ, –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
# –ï—Å—Ç—å 3 —Å–ø–æ—Å–æ–±–∞ –æ–±—Ö–æ–¥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è —É–∑–ª–æ–≤

def dfs_inorder_recursive(node, result=None):
    """
    –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ–±—Ö–æ–¥ (In-order): –õ–ï–í–´–ô -> –ö–û–†–ï–ù–¨ -> –ü–†–ê–í–´–ô
    –í–∞–∂–Ω–∞—è —Ñ–∏—à–∫–∞: –¥–ª—è BST –¥–∞—ë—Ç –û–¢–°–û–†–¢–ò–†–û–í–ê–ù–ù–´–ô —Å–ø–∏—Å–æ–∫!
    –ü–æ—Ä—è–¥–æ–∫: —Å–Ω–∞—á–∞–ª–∞ –≤—Å—ë —Å–ª–µ–≤–∞, –ø–æ—Ç–æ–º —Å–∞–º —É–∑–µ–ª, –ø–æ—Ç–æ–º –≤—Å—ë —Å–ø—Ä–∞–≤–∞
    """
    if result is None:
        result = []
    
    if node is not None:
        dfs_inorder_recursive(node['left'], result)    # 1. –û–±—Ö–æ–¥–∏–º –≤—Å—ë –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        result.append(node['value'])                    # 2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
        dfs_inorder_recursive(node['right'], result)   # 3. –û–±—Ö–æ–¥–∏–º –≤—Å—ë –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
    
    return result


def dfs_preorder_recursive(node, result=None):
    """
    –ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ (Pre-order): –ö–û–†–ï–ù–¨ -> –õ–ï–í–´–ô -> –ü–†–ê–í–´–ô
    –£–¥–æ–±–µ–Ω –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ—Ä–µ–≤–∞
    –ü–æ—Ä—è–¥–æ–∫: —Å–Ω–∞—á–∞–ª–∞ —Å–∞–º —É–∑–µ–ª, –ø–æ—Ç–æ–º –¥–µ—Ç–∏
    """
    if result is None:
        result = []
    
    if node is not None:
        result.append(node['value'])                     # 1. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
        dfs_preorder_recursive(node['left'], result)    # 2. –û–±—Ö–æ–¥–∏–º –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        dfs_preorder_recursive(node['right'], result)   # 3. –û–±—Ö–æ–¥–∏–º –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
    
    return result


def dfs_postorder_recursive(node, result=None):
    """
    –û–±—Ä–∞—Ç–Ω—ã–π –æ–±—Ö–æ–¥ (Post-order): –õ–ï–í–´–ô -> –ü–†–ê–í–´–ô -> –ö–û–†–ï–ù–¨
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ (—Å–Ω–∞—á–∞–ª–∞ –¥–µ—Ç–µ–π, –ø–æ—Ç–æ–º —Ä–æ–¥–∏—Ç–µ–ª—è)
    –ü–æ—Ä—è–¥–æ–∫: —Å–Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ—Ö –¥–µ—Ç–µ–π, –ø–æ—Ç–æ–º —Å–∞–º —É–∑–µ–ª
    """
    if result is None:
        result = []
    
    if node is not None:
        dfs_postorder_recursive(node['left'], result)   # 1. –û–±—Ö–æ–¥–∏–º –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        dfs_postorder_recursive(node['right'], result)  # 2. –û–±—Ö–æ–¥–∏–º –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
        result.append(node['value'])                     # 3. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
    
    return result


def dfs_inorder_iterative(root):
    """
    –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ–±—Ö–æ–¥ –ë–ï–ó —Ä–µ–∫—É—Ä—Å–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–µ–∫ –≤—Ä—É—á–Ω—É—é
    –°—Ç–µ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–ø–æ–º–Ω–∏—Ç—å —É–∑–ª—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è
    """
    result = []
    stack = []       # –ù–∞—à —Å—Ç–µ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —É–∑–ª–æ–≤
    current = root
    
    while current is not None or stack:
        # –ò–¥—ë–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–ª–µ–≤–æ, —Å–∫–ª–∞–¥—ã–≤–∞—è –≤—Å–µ —É–∑–ª—ã –≤ —Å—Ç–µ–∫
        while current is not None:
            stack.append(current)
            current = current['left']
        
        # –î–æ—Å—Ç–∏–≥–ª–∏ —Å–∞–º–æ–≥–æ –ª–µ–≤–æ–≥–æ —É–∑–ª–∞, –±–µ—Ä—ë–º –µ–≥–æ –∏–∑ —Å—Ç–µ–∫–∞
        current = stack.pop()
        result.append(current['value'])  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —É–∑–µ–ª
        
        # –¢–µ–ø–µ—Ä—å –∏–¥—ë–º –≤–ø—Ä–∞–≤–æ –æ—Ç —ç—Ç–æ–≥–æ —É–∑–ª–∞
        current = current['right']
    
    return result


def dfs_preorder_iterative(root):
    """
    –ü—Ä—è–º–æ–π –æ–±—Ö–æ–¥ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏
    –¢—É—Ç –ø—Ä–æ—â–µ - –ø—Ä–æ—Å—Ç–æ –∫–ª–∞–¥—ë–º —É–∑–ª—ã –≤ —Å—Ç–µ–∫ –∏ —Å—Ä–∞–∑—É –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
    """
    if root is None:
        return []
    
    result = []
    stack = [root]  # –ù–∞—á–∏–Ω–∞–µ–º —Å –∫–æ—Ä–Ω—è
    
    while stack:
        # –ë–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —É–∑–µ–ª –∏–∑ —Å—Ç–µ–∫–∞
        node = stack.pop()
        result.append(node['value'])  # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ–≥–æ —Å—Ä–∞–∑—É
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–π –≤ —Å—Ç–µ–∫
        # –í–ê–ñ–ù–û: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–∞–≤–æ–≥–æ (–æ–Ω –æ–∫–∞–∂–µ—Ç—Å—è –≥–ª—É–±–∂–µ –≤ —Å—Ç–µ–∫–µ)
        # —á—Ç–æ–±—ã –ª–µ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç–∞–ª—Å—è –ø–µ—Ä–≤—ã–º (—Å—Ç–µ–∫ = LIFO)
        if node['right']:
            stack.append(node['right'])
        if node['left']:
            stack.append(node['left'])
    
    return result


def dfs_postorder_iterative(root):
    """
    –û–±—Ä–∞—Ç–Ω—ã–π –æ–±—Ö–æ–¥ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏ - —Å–∞–º—ã–π —Ö–∏—Ç—Ä—ã–π!
    –ò—Å–ø–æ–ª—å–∑—É–µ–º –î–í–ê —Å—Ç–µ–∫–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
    """
    if root is None:
        return []
    
    result = []
    stack1 = [root]  # –ü–µ—Ä–≤—ã–π —Å—Ç–µ–∫ –¥–ª—è –æ–±—Ö–æ–¥–∞
    stack2 = []      # –í—Ç–æ—Ä–æ–π —Å—Ç–µ–∫ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
    
    # –ü–µ—Ä–≤—ã–π –ø—Ä–æ—Ö–æ–¥ - —Å–∫–ª–∞–¥—ã–≤–∞–µ–º —É–∑–ª—ã –≤–æ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–∫
    while stack1:
        node = stack1.pop()
        stack2.append(node)  # –ö–ª–∞–¥—ë–º –≤–æ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–∫ (–Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º!)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–π –≤ –ø–µ—Ä–≤—ã–π —Å—Ç–µ–∫
        if node['left']:
            stack1.append(node['left'])
        if node['right']:
            stack1.append(node['right'])
    
    # –í—Ç–æ—Ä–æ–π –ø—Ä–æ—Ö–æ–¥ - –¥–æ—Å—Ç–∞—ë–º –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —Å—Ç–µ–∫–∞ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
    # –ü–æ–ª—É—á–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ - –∫–∞–∫ —Ä–∞–∑ —Ç–æ —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è post-order
    while stack2:
        result.append(stack2.pop()['value'])
    
    return result


# ============== –ü–û–ò–°–ö –í –®–ò–†–ò–ù–£ (BFS - Breadth First Search) ==============
# BFS –æ–±—Ö–æ–¥–∏—Ç –¥–µ—Ä–µ–≤–æ –ø–æ —É—Ä–æ–≤–Ω—è–º: —Å–Ω–∞—á–∞–ª–∞ –≤–µ—Å—å —É—Ä–æ–≤–µ–Ω—å 0, –ø–æ—Ç–æ–º —É—Ä–æ–≤–µ–Ω—å 1, –∏ —Ç.–¥.
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –û–ß–ï–†–ï–î–¨ (FIFO) –≤–º–µ—Å—Ç–æ —Å—Ç–µ–∫–∞ (LIFO)

def bfs_iterative(root):
    """
    –ü–æ–∏—Å–∫ –≤ —à–∏—Ä–∏–Ω—É —Å –æ—á–µ—Ä–µ–¥—å—é
    –ò–¥–µ—è: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —É–∑–µ–ª –∏ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ—Ö –µ–≥–æ –¥–µ—Ç–µ–π –≤ –æ—á–µ—Ä–µ–¥—å
    –ü–æ–ª—É—á–∞–µ—Ç—Å—è –æ–±—Ö–æ–¥ –ø–æ —É—Ä–æ–≤–Ω—è–º
    """
    if root is None:
        return []
    
    result = []
    queue = [root]  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞–∫ –æ—á–µ—Ä–µ–¥—å
    
    while queue:
        node = queue.pop(0)  # –ë–µ—Ä—ë–º –ü–ï–†–í–´–ô —ç–ª–µ–º–µ–Ω—Ç (FIFO - First In First Out)
        result.append(node['value'])
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–π —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –≤ –ö–û–ù–ï–¶ –æ—á–µ—Ä–µ–¥–∏
        # –û–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∞—é—Ç—Å—è –ø–æ—Ç–æ–º, –ø–æ—Å–ª–µ –≤—Å–µ—Ö —É–∑–ª–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        if node['left']:
            queue.append(node['left'])
        if node['right']:
            queue.append(node['right'])
    
    return result


def bfs_recursive(root):
    """
    –ü–æ–∏—Å–∫ –≤ —à–∏—Ä–∏–Ω—É —á–µ—Ä–µ–∑ —Ä–µ–∫—É—Ä—Å–∏—é - –º–µ–Ω–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–π —Å–ø–æ—Å–æ–±
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–µ—Å—å —É—Ä–æ–≤–µ–Ω—å —Ü–µ–ª–∏–∫–æ–º, –ø–æ—Ç–æ–º –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
    """
    if root is None:
        return []
    
    result = []
    
    def process_level(nodes):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ä–µ–≤–∞"""
        if not nodes:
            return  # –ó–∞–∫–æ–Ω—á–∏–ª–∏—Å—å —É—Ä–æ–≤–Ω–∏
        
        next_level = []  # –°–æ–±–∏—Ä–∞–µ–º —É–∑–ª—ã —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —É–∑–ª—ã —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        for node in nodes:
            result.append(node['value'])
            # –°–æ–±–∏—Ä–∞–µ–º –¥–µ—Ç–µ–π –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
            if node['left']:
                next_level.append(node['left'])
            if node['right']:
                next_level.append(node['right'])
        
        # –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        process_level(next_level)
    
    process_level([root])  # –ù–∞—á–∏–Ω–∞–µ–º —Å –∫–æ—Ä–Ω—è
    return result


# ============== –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ï–†–ï–í–ê ==============
# –ü—Ä–æ—Å—Ç–æ —Ä–∏—Å—É–µ–º –¥–µ—Ä–µ–≤–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏

def display_tree(root, level=0, prefix="Root: "):
    """
    –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Ä–∏—Å—É–µ–º –¥–µ—Ä–µ–≤–æ
    –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç—Å—Ç—É–ø—ã –¥–ª—è –ø–æ–∫–∞–∑–∞ —É—Ä–æ–≤–Ω–µ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
    """
    if root is None:
        return
    
    # –ü–µ—á–∞—Ç–∞–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª —Å –æ—Ç—Å—Ç—É–ø–æ–º
    print(" " * (level * 4) + prefix + str(root['value']))
    
    # –ï—Å–ª–∏ –µ—Å—Ç—å –¥–µ—Ç–∏ - —Ä–∏—Å—É–µ–º –∏—Ö
    if root['left'] is not None or root['right'] is not None:
        if root['left']:
            display_tree(root['left'], level + 1, "L--- ")  # L = –ª–µ–≤—ã–π
        else:
            print(" " * ((level + 1) * 4) + "L--- None")
        
        if root['right']:
            display_tree(root['right'], level + 1, "R--- ")  # R = –ø—Ä–∞–≤—ã–π
        else:
            print(" " * ((level + 1) * 4) + "R--- None")


def display_tree_compact(root):
    """
    –í—ã–≤–æ–¥ –¥–µ—Ä–µ–≤–∞ —Å —Ä–∞–º–æ—á–∫–æ–π –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
    """
    if root is None:
        print("–î–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ")
        return
    
    print("\n" + "="*50)
    display_tree(root)
    print("="*50 + "\n")


# ============== –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê ==============

if __name__ == "__main__":
    print("üå≥ –î–í–û–ò–ß–ù–û–ï –î–ï–†–ï–í–û –ü–û–ò–°–ö–ê üå≥\n")
    
    # –°–æ–∑–¥–∞—ë–º –¥–µ—Ä–µ–≤–æ
    tree = None
    
    # –í—Å—Ç–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    print("=== –í–°–¢–ê–í–ö–ê –≠–õ–ï–ú–ï–ù–¢–û–í ===")
    values = [50, 30, 70, 20, 40, 60, 80]
    for val in values:
        tree = insert(tree, val)
        print(f"–í—Å—Ç–∞–≤–ª–µ–Ω {val}")
    
    display_tree_compact(tree)
    
    # –ü—ã—Ç–∞–µ–º—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç
    print("\n=== –ü–û–ü–´–¢–ö–ê –í–°–¢–ê–í–ò–¢–¨ –î–£–ë–õ–ò–ö–ê–¢ ===")
    tree = insert(tree, 50)
    
    # –ü–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É (DFS)
    print("\n=== –ü–û–ò–°–ö –í –ì–õ–£–ë–ò–ù–£ (DFS) - –†–ï–ö–£–†–°–ò–í–ù–´–ô ===")
    print("–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π (In-order):", dfs_inorder_recursive(tree))
    print("–ü—Ä—è–º–æ–π (Pre-order):", dfs_preorder_recursive(tree))
    print("–û–±—Ä–∞—Ç–Ω—ã–π (Post-order):", dfs_postorder_recursive(tree))
    
    print("\n=== –ü–û–ò–°–ö –í –ì–õ–£–ë–ò–ù–£ (DFS) - –ò–¢–ï–†–ê–¢–ò–í–ù–´–ô ===")
    print("–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π (In-order):", dfs_inorder_iterative(tree))
    print("–ü—Ä—è–º–æ–π (Pre-order):", dfs_preorder_iterative(tree))
    print("–û–±—Ä–∞—Ç–Ω—ã–π (Post-order):", dfs_postorder_iterative(tree))
    
    # –ü–æ–∏—Å–∫ –≤ —à–∏—Ä–∏–Ω—É (BFS)
    print("\n=== –ü–û–ò–°–ö –í –®–ò–†–ò–ù–£ (BFS) ===")
    print("–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π:", bfs_iterative(tree))
    print("–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π:", bfs_recursive(tree))
    
    # –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    print("\n=== –£–î–ê–õ–ï–ù–ò–ï –≠–õ–ï–ú–ï–ù–¢–û–í ===")
    
    print("\n1. –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–∞ (20):")
    tree = delete(tree, 20)
    display_tree_compact(tree)
    
    print("\n2. –£–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–∞ —Å –æ–¥–Ω–∏–º —Ä–µ–±—ë–Ω–∫–æ–º (30):")
    tree = delete(tree, 30)
    display_tree_compact(tree)
    
    print("\n3. –£–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–∞ —Å –¥–≤—É–º—è –¥–µ—Ç—å–º–∏ (50 - –∫–æ—Ä–µ–Ω—å):")
    tree = delete(tree, 50)
    display_tree_compact(tree)
    
    print("\n4. –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç (100):")
    tree = delete(tree, 100)
    
    print("\n=== –§–ò–ù–ê–õ–¨–ù–û–ï –î–ï–†–ï–í–û ===")
    display_tree_compact(tree)
    print("–°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ–±—Ö–æ–¥ (–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):", dfs_inorder_recursive(tree))
