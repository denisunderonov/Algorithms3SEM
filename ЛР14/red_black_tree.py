"""
–õ–†14: –ö—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ (Red-Black Tree)

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∞–º–æ–±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–µ–≥–æ—Å—è –¥–≤–æ–∏—á–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –ø–æ–∏—Å–∫–∞ —Å –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏.

–ö—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:
1. –ö–∞–∂–¥—ã–π —É–∑–µ–ª –æ–∫—Ä–∞—à–µ–Ω –≤ –∫—Ä–∞—Å–Ω—ã–π –∏–ª–∏ —á—ë—Ä–Ω—ã–π —Ü–≤–µ—Ç
2. –ö–æ—Ä–µ–Ω—å –≤—Å–µ–≥–¥–∞ —á—ë—Ä–Ω—ã–π
3. –í—Å–µ –ª–∏—Å—Ç—å—è (NIL) ‚Äî —á—ë—Ä–Ω—ã–µ
4. –ö—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫—Ä–∞—Å–Ω—ã—Ö –¥–µ—Ç–µ–π
5. –í—Å–µ –ø—É—Ç–∏ –æ—Ç —É–∑–ª–∞ –¥–æ –ª–∏—Å—Ç—å–µ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á—ë—Ä–Ω—ã—Ö —É–∑–ª–æ–≤
"""

from enum import Enum
from typing import Optional


class Color(Enum):
    """–¶–≤–µ—Ç–∞ —É–∑–ª–æ–≤ –¥–µ—Ä–µ–≤–∞."""
    RED = "üî¥"
    BLACK = "‚ö´"


class RBNode:
    """–£–∑–µ–ª –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞."""
    
    def __init__(self, value: int, color: Color = Color.RED):
        self.value = value
        self.color = color
        self.left: Optional[RBNode] = None
        self.right: Optional[RBNode] = None
        self.parent: Optional[RBNode] = None
    
    def __repr__(self):
        return f"{self.color.value}{self.value}"


class RedBlackTree:
    """
    –ö—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π.
    
    –û–ø–µ—Ä–∞—Ü–∏–∏:
    - insert(value) ‚Äî –≤—Å—Ç–∞–≤–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    - delete(value) ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
    - search(value) ‚Äî –ø–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞
    - display() ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞
    """
    
    def __init__(self):
        self.NIL = RBNode(0, Color.BLACK)  # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —É–∑–µ–ª-–ª–∏—Å—Ç
        self.root = self.NIL
    
    # ========================================================================
    # –í–°–¢–ê–í–ö–ê
    # ========================================================================
    
    def insert(self, value: int):
        """
        –í—Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ.
        
        –ü–†–û–¶–ï–°–°:
        1. –í—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–µ BST (–∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º)
        2. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∫—Ä–∞—Å–∫–∏ –∏ –ø–æ–≤–æ—Ä–æ—Ç—ã
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n)
        """
        # –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π —É–∑–µ–ª (–≤—Å–µ–≥–¥–∞ –∫—Ä–∞—Å–Ω—ã–π –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ)
        new_node = RBNode(value, Color.RED)
        # –î–µ—Ç–∏ –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞ ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ NIL-—É–∑–ª—ã (—á—ë—Ä–Ω—ã–µ –ª–∏—Å—Ç—å—è)
        new_node.left = self.NIL
        new_node.right = self.NIL
        
        # –®–ê–ì 1: –û–±—ã—á–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ BST
        # –ò—â–µ–º –º–µ—Å—Ç–æ –¥–ª—è –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞
        parent = None  # –ë—É–¥—É—â–∏–π —Ä–æ–¥–∏—Ç–µ–ª—å –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞
        current = self.root  # –ù–∞—á–∏–Ω–∞–µ–º —Å –∫–æ—Ä–Ω—è
        
        # –°–ø—É—Å–∫–∞–µ–º—Å—è –ø–æ –¥–µ—Ä–µ–≤—É, –ø–æ–∫–∞ –Ω–µ –¥–æ–π–¥—ë–º –¥–æ NIL
        while current != self.NIL:
            parent = current  # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è
            # –ò–¥—ë–º –≤–ª–µ–≤–æ –∏–ª–∏ –≤–ø—Ä–∞–≤–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è
            if new_node.value < current.value:
                current = current.left
            else:
                current = current.right
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞
        new_node.parent = parent
        
        # –ï—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—è –Ω–µ—Ç ‚Äî –Ω–æ–≤—ã–π —É–∑–µ–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ—Ä–Ω–µ–º
        if parent is None:
            self.root = new_node
        # –ò–Ω–∞—á–µ –ø–æ–¥–≤–µ—à–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —É–∑–µ–ª –∫ —Ä–æ–¥–∏—Ç–µ–ª—é (—Å–ª–µ–≤–∞ –∏–ª–∏ —Å–ø—Ä–∞–≤–∞)
        elif new_node.value < parent.value:
            parent.left = new_node
        else:
            parent.right = new_node
        
        # –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
        
        # –ï—Å–ª–∏ –Ω–æ–≤—ã–π —É–∑–µ–ª ‚Äî –∫–æ—Ä–µ–Ω—å, –∫—Ä–∞—Å–∏–º –µ–≥–æ –≤ —á—ë—Ä–Ω—ã–π –∏ –≤—ã—Ö–æ–¥–∏–º
        if new_node.parent is None:
            new_node.color = Color.BLACK
            return
        
        # –ï—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å ‚Äî –∫–æ—Ä–µ–Ω—å, –≤—Å—ë –û–ö (–∫—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –ø–æ–¥ —á—ë—Ä–Ω—ã–º –∫–æ—Ä–Ω–µ–º)
        if new_node.parent.parent is None:
            return
        
        # –®–ê–ì 2: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
        # (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞: –∫—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –ø–æ–¥ –∫—Ä–∞—Å–Ω—ã–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º)
        self._fix_insert(new_node)
    
    def _fix_insert(self, node: RBNode):
        """
        –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏.
        
        –ü–†–û–ë–õ–ï–ú–ê: –∫—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫—Ä–∞—Å–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (–Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ 4).
        
        –†–ï–®–ï–ù–ò–Ø (3 —Å–ª—É—á–∞—è):
        1. –î—è–¥—è –∫—Ä–∞—Å–Ω—ã–π ‚Üí –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è, –¥—è–¥—é –∏ –¥–µ–¥—É—à–∫—É
        2. –£–∑–µ–ª ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–µ–±—ë–Ω–æ–∫ ‚Üí –ø–æ–≤–æ—Ä–æ—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ä–æ–¥–∏—Ç–µ–ª—è
        3. –£–∑–µ–ª ‚Äî –≤–Ω–µ—à–Ω–∏–π —Ä–µ–±—ë–Ω–æ–∫ ‚Üí –ø–µ—Ä–µ–∫—Ä–∞—Å–∫–∞ + –ø–æ–≤–æ—Ä–æ—Ç –¥–µ–¥—É—à–∫–∏
        """
        # –¶–∏–∫–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞ —Ä–æ–¥–∏—Ç–µ–ª—å –∫—Ä–∞—Å–Ω—ã–π (–µ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏–µ)
        while node.parent.color == Color.RED:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —Å –∫–∞–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç –¥–µ–¥—É—à–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª—å
            
            # –°–õ–£–ß–ê–ô A: –†–æ–¥–∏—Ç–µ–ª—å ‚Äî –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –¥–µ–¥—É—à–∫–∏
            if node.parent == node.parent.parent.right:
                # –î—è–¥—è ‚Äî –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –¥–µ–¥—É—à–∫–∏
                uncle = node.parent.parent.left
                
                # –°–õ–£–ß–ê–ô 1: –î—è–¥—è –∫—Ä–∞—Å–Ω—ã–π
                if uncle.color == Color.RED:
                    # –†–ï–®–ï–ù–ò–ï: –ø–µ—Ä–µ–∫—Ä–∞—à–∏–≤–∞–µ–º
                    uncle.color = Color.BLACK          # –î—è–¥—è ‚Üí —á—ë—Ä–Ω—ã–π
                    node.parent.color = Color.BLACK    # –†–æ–¥–∏—Ç–µ–ª—å ‚Üí —á—ë—Ä–Ω—ã–π
                    node.parent.parent.color = Color.RED  # –î–µ–¥—É—à–∫–∞ ‚Üí –∫—Ä–∞—Å–Ω—ã–π
                    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å –¥–µ–¥—É—à–∫–∏ (–æ–Ω —Å—Ç–∞–ª –∫—Ä–∞—Å–Ω—ã–º)
                    node = node.parent.parent
                else:
                    # –î—è–¥—è —á—ë—Ä–Ω—ã–π (–∏–ª–∏ NIL)
                    
                    # –°–õ–£–ß–ê–ô 2: –£–∑–µ–ª ‚Äî –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
                    if node == node.parent.left:
                        # –†–ï–®–ï–ù–ò–ï: –ø—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
                        node = node.parent
                        self._rotate_right(node)
                        # –ü–æ—Å–ª–µ –ø–æ–≤–æ—Ä–æ—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª—É—á–∞—é 3
                    
                    # –°–õ–£–ß–ê–ô 3: –£–∑–µ–ª ‚Äî –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–≤–Ω–µ—à–Ω–∏–π)
                    # –†–ï–®–ï–ù–ò–ï: –ø–µ—Ä–µ–∫—Ä–∞—Å–∫–∞ + –ª–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç –¥–µ–¥—É—à–∫–∏
                    node.parent.color = Color.BLACK           # –†–æ–¥–∏—Ç–µ–ª—å ‚Üí —á—ë—Ä–Ω—ã–π
                    node.parent.parent.color = Color.RED      # –î–µ–¥—É—à–∫–∞ ‚Üí –∫—Ä–∞—Å–Ω—ã–π
                    self._rotate_left(node.parent.parent)     # –õ–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç –¥–µ–¥—É—à–∫–∏
            
            # –°–õ–£–ß–ê–ô B: –†–æ–¥–∏—Ç–µ–ª—å ‚Äî –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –¥–µ–¥—É—à–∫–∏ (–∑–µ—Ä–∫–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
            else:
                uncle = node.parent.parent.right  # –î—è–¥—è —Å–ø—Ä–∞–≤–∞
                
                # –°–õ–£–ß–ê–ô 1: –î—è–¥—è –∫—Ä–∞—Å–Ω—ã–π
                if uncle.color == Color.RED:
                    uncle.color = Color.BLACK
                    node.parent.color = Color.BLACK
                    node.parent.parent.color = Color.RED
                    node = node.parent.parent
                else:
                    # –°–õ–£–ß–ê–ô 2: –£–∑–µ–ª ‚Äî –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
                    if node == node.parent.right:
                        node = node.parent
                        self._rotate_left(node)  # –õ–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
                    
                    # –°–õ–£–ß–ê–ô 3: –£–∑–µ–ª ‚Äî –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ (–≤–Ω–µ—à–Ω–∏–π)
                    node.parent.color = Color.BLACK
                    node.parent.parent.color = Color.RED
                    self._rotate_right(node.parent.parent)  # –ü—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç –¥–µ–¥—É—à–∫–∏
            
            # –ï—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ –∫–æ—Ä–Ω—è ‚Äî –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
            if node == self.root:
                break
        
        # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–æ—Ä–µ–Ω—å –≤—Å–µ–≥–¥–∞ —á—ë—Ä–Ω—ã–π (–ø—Ä–∞–≤–∏–ª–æ 2)
        self.root.color = Color.BLACK
    
    # ========================================================================
    # –£–î–ê–õ–ï–ù–ò–ï
    # ========================================================================
    
    def delete(self, value: int):
        """
        –£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n)
        """
        # –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Ö–æ–¥–∏–º —É–∑–µ–ª —Å –Ω—É–∂–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
        node = self._search_node(self.root, value)
        
        # –ï—Å–ª–∏ —É–∑–µ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã—Ö–æ–¥–∏–º
        if node == self.NIL:
            print(f"–≠–ª–µ–º–µ–Ω—Ç {value} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –¥–µ—Ä–µ–≤–µ")
            return
        
        # –£–¥–∞–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π —É–∑–µ–ª —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–≤–æ–π—Å—Ç–≤
        self._delete_node(node)
    
    def _delete_node(self, node: RBNode):
        """
        –£–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–∞ —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤.
        
        –ü–†–û–¶–ï–°–°:
        1. –£–¥–∞–ª—è–µ–º —É–∑–µ–ª –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–º BST
        2. –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ —á—ë—Ä–Ω—ã–π —É–∑–µ–ª ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–∞
        """
        # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ü–≤–µ—Ç —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞
        # –ï—Å–ª–∏ –æ–Ω –±—ã–ª —á—ë—Ä–Ω—ã–º, –ø—Ä–∏–¥—ë—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å
        original_color = node.color
        
        # –°–õ–£–ß–ê–ô 1: –ù–µ—Ç –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞
        if node.left == self.NIL:
            # –£–∑–µ–ª x –∑–∞–π–º—ë—Ç –º–µ—Å—Ç–æ —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞
            x = node.right
            # –ó–∞–º–µ–Ω—è–µ–º —É–∑–µ–ª –µ–≥–æ –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            self._transplant(node, node.right)
        
        # –°–õ–£–ß–ê–ô 2: –ù–µ—Ç –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞
        elif node.right == self.NIL:
            x = node.left
            # –ó–∞–º–µ–Ω—è–µ–º —É–∑–µ–ª –µ–≥–æ –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            self._transplant(node, node.left)
        
        # –°–õ–£–ß–ê–ô 3: –ï—Å—Ç—å –æ–±–∞ —Ä–µ–±—ë–Ω–∫–∞ (—Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π)
        else:
            # –ù–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º—É–º –≤ –ø—Ä–∞–≤–æ–º –ø–æ–¥–¥–µ—Ä–µ–≤–µ (–ø—Ä–µ–µ–º–Ω–∏–∫)
            y = self._minimum(node.right)
            # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Ü–≤–µ—Ç –ø—Ä–µ–µ–º–Ω–∏–∫–∞
            original_color = y.color
            # x ‚Äî –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –ø—Ä–µ–µ–º–Ω–∏–∫–∞ (–∑–∞–π–º—ë—Ç –µ–≥–æ –º–µ—Å—Ç–æ)
            x = y.right
            
            # –ï—Å–ª–∏ –ø—Ä–µ–µ–º–Ω–∏–∫ ‚Äî –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–±—ë–Ω–æ–∫ —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞
            if y.parent == node:
                # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è x
                x.parent = y
            else:
                # –ò–Ω–∞—á–µ –∑–∞–º–µ–Ω—è–µ–º –ø—Ä–µ–µ–º–Ω–∏–∫–∞ –µ–≥–æ –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
                self._transplant(y, y.right)
                # –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞ –∫ –ø—Ä–µ–µ–º–Ω–∏–∫—É
                y.right = node.right
                y.right.parent = y
            
            # –ó–∞–º–µ–Ω—è–µ–º —É–¥–∞–ª—è–µ–º—ã–π —É–∑–µ–ª –ø—Ä–µ–µ–º–Ω–∏–∫–æ–º
            self._transplant(node, y)
            # –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
            y.left = node.left
            y.left.parent = y
            # –ö–æ–ø–∏—Ä—É–µ–º —Ü–≤–µ—Ç —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞
            y.color = node.color
        
        # –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ —á—ë—Ä–Ω—ã–π —É–∑–µ–ª ‚Äî –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞
        # (—É–¥–∞–ª–µ–Ω–∏–µ —á—ë—Ä–Ω–æ–≥–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ 5 ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ —á—ë—Ä–Ω—ã—Ö —É–∑–ª–æ–≤)
        if original_color == Color.BLACK:
            self._fix_delete(x)
    
    def _fix_delete(self, node: RBNode):
        """–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è."""
        while node != self.root and node.color == Color.BLACK:
            if node == node.parent.left:
                sibling = node.parent.right
                
                if sibling.color == Color.RED:
                    sibling.color = Color.BLACK
                    node.parent.color = Color.RED
                    self._rotate_left(node.parent)
                    sibling = node.parent.right
                
                if sibling.left.color == Color.BLACK and sibling.right.color == Color.BLACK:
                    sibling.color = Color.RED
                    node = node.parent
                else:
                    if sibling.right.color == Color.BLACK:
                        sibling.left.color = Color.BLACK
                        sibling.color = Color.RED
                        self._rotate_right(sibling)
                        sibling = node.parent.right
                    
                    sibling.color = node.parent.color
                    node.parent.color = Color.BLACK
                    sibling.right.color = Color.BLACK
                    self._rotate_left(node.parent)
                    node = self.root
            else:
                sibling = node.parent.left
                
                if sibling.color == Color.RED:
                    sibling.color = Color.BLACK
                    node.parent.color = Color.RED
                    self._rotate_right(node.parent)
                    sibling = node.parent.left
                
                if sibling.right.color == Color.BLACK and sibling.left.color == Color.BLACK:
                    sibling.color = Color.RED
                    node = node.parent
                else:
                    if sibling.left.color == Color.BLACK:
                        sibling.right.color = Color.BLACK
                        sibling.color = Color.RED
                        self._rotate_left(sibling)
                        sibling = node.parent.left
                    
                    sibling.color = node.parent.color
                    node.parent.color = Color.BLACK
                    sibling.left.color = Color.BLACK
                    self._rotate_right(node.parent)
                    node = self.root
        
        node.color = Color.BLACK
    
    # ========================================================================
    # –ü–û–í–û–†–û–¢–´
    # ========================================================================
    
    def _rotate_left(self, node: RBNode):
        """
        –õ–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ —É–∑–ª–∞.
        
        –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø:
        –î–æ:                –ü–æ—Å–ª–µ:
            node              right
           /    \            /    \
          A    right  =>  node    C
               /   \      /   \
              B     C    A     B
        
        –¶–ï–õ–¨: –ø–æ–¥–Ω—è—Ç—å –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –Ω–∞–≤–µ—Ä—Ö, –æ–ø—É—Å—Ç–∏—Ç—å —É–∑–µ–ª –≤–Ω–∏–∑-–≤–ª–µ–≤–æ.
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –¥–µ—Ä–µ–≤–∞.
        """
        # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ (–æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–æ–≤—ã–º –∫–æ—Ä–Ω–µ–º –ø–æ–¥–¥–µ—Ä–µ–≤–∞)
        right = node.right
        
        # –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ right –Ω–∞ –º–µ—Å—Ç–æ –ø—Ä–∞–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ node
        node.right = right.left
        
        # –ï—Å–ª–∏ —É right –±—ã–ª –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è
        if right.left != self.NIL:
            right.left.parent = node
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è right (–æ–Ω –∑–∞–Ω–∏–º–∞–µ—Ç –º–µ—Å—Ç–æ node)
        right.parent = node.parent
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É —É —Ä–æ–¥–∏—Ç–µ–ª—è node
        if node.parent is None:
            # –ï—Å–ª–∏ node –±—ã–ª –∫–æ—Ä–Ω–µ–º, right —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –∫–æ—Ä–Ω–µ–º
            self.root = right
        elif node == node.parent.left:
            # –ï—Å–ª–∏ node –±—ã–ª –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º, right —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            node.parent.left = right
        else:
            # –ï—Å–ª–∏ node –±—ã–ª –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º, right —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            node.parent.right = right
        
        # –ü–æ–º–µ—â–∞–µ–º node –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ right
        right.left = node
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è node
        node.parent = right
    
    def _rotate_right(self, node: RBNode):
        """
        –ü—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ —É–∑–ª–∞.
        
        –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø:
        –î–æ:               –ü–æ—Å–ª–µ:
            node            left
           /    \          /    \
         left    C   =>   A    node
        /   \                  /   \
       A     B                B     C
        
        –¶–ï–õ–¨: –ø–æ–¥–Ω—è—Ç—å –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –Ω–∞–≤–µ—Ä—Ö, –æ–ø—É—Å—Ç–∏—Ç—å —É–∑–µ–ª –≤–Ω–∏–∑-–≤–ø—Ä–∞–≤–æ.
        –ó–µ—Ä–∫–∞–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∫ –ª–µ–≤–æ–º—É –ø–æ–≤–æ—Ä–æ—Ç—É.
        """
        # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ (–æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–æ–≤—ã–º –∫–æ—Ä–Ω–µ–º –ø–æ–¥–¥–µ—Ä–µ–≤–∞)
        left = node.left
        
        # –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ left –Ω–∞ –º–µ—Å—Ç–æ –ª–µ–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ node
        node.left = left.right
        
        # –ï—Å–ª–∏ —É left –±—ã–ª –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è
        if left.right != self.NIL:
            left.right.parent = node
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è left
        left.parent = node.parent
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É —É —Ä–æ–¥–∏—Ç–µ–ª—è node
        if node.parent is None:
            # –ï—Å–ª–∏ node –±—ã–ª –∫–æ—Ä–Ω–µ–º, left —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –∫–æ—Ä–Ω–µ–º
            self.root = left
        elif node == node.parent.right:
            # –ï—Å–ª–∏ node –±—ã–ª –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º, left —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∞–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            node.parent.right = left
        else:
            # –ï—Å–ª–∏ node –±—ã–ª –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º, left —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≤—ã–º —Ä–µ–±—ë–Ω–∫–æ–º
            node.parent.left = left
        
        # –ü–æ–º–µ—â–∞–µ–º node –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ left
        left.right = node
        # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è node
        node.parent = left
    
    # ========================================================================
    # –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´
    # ========================================================================
    
    def _transplant(self, u: RBNode, v: RBNode):
        """–ó–∞–º–µ–Ω–∏—Ç—å –ø–æ–¥–¥–µ—Ä–µ–≤–æ u –Ω–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–æ v."""
        if u.parent is None:
            self.root = v
        elif u == u.parent.left:
            u.parent.left = v
        else:
            u.parent.right = v
        v.parent = u.parent
    
    def _minimum(self, node: RBNode) -> RBNode:
        """–ù–∞–π—Ç–∏ –º–∏–Ω–∏–º—É–º –≤ –ø–æ–¥–¥–µ—Ä–µ–≤–µ."""
        while node.left != self.NIL:
            node = node.left
        return node
    
    def _search_node(self, node: RBNode, value: int) -> RBNode:
        """–ù–∞–π—Ç–∏ —É–∑–µ–ª —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º."""
        if node == self.NIL or value == node.value:
            return node
        
        if value < node.value:
            return self._search_node(node.left, value)
        return self._search_node(node.right, value)
    
    def search(self, value: int) -> bool:
        """–ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –¥–µ—Ä–µ–≤–µ."""
        return self._search_node(self.root, value) != self.NIL
    
    # ========================================================================
    # –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
    # ========================================================================
    
    def display(self):
        """–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–µ—Ä–µ–≤–∞."""
        if self.root == self.NIL:
            print("–î–µ—Ä–µ–≤–æ –ø—É—Å—Ç–æ–µ")
            return
        
        print("\n" + "=" * 60)
        print("–ö–†–ê–°–ù–û-–ß–Å–†–ù–û–ï –î–ï–†–ï–í–û")
        print("=" * 60)
        self._print_tree(self.root, "", True)
        print("=" * 60 + "\n")
    
    def _print_tree(self, node: RBNode, prefix: str, is_tail: bool):
        """–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –¥–µ—Ä–µ–≤–∞."""
        if node == self.NIL:
            return
        
        if node.right != self.NIL:
            new_prefix = prefix + ("‚îÇ   " if is_tail else "    ")
            self._print_tree(node.right, new_prefix, False)
        
        print(prefix + ("‚îî‚îÄ‚îÄ " if is_tail else "‚îå‚îÄ‚îÄ ") + str(node))
        
        if node.left != self.NIL:
            new_prefix = prefix + ("    " if is_tail else "‚îÇ   ")
            self._print_tree(node.left, new_prefix, True)
    
    def check_properties(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤."""
        print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤:")
        
        # 1. –ö–æ—Ä–µ–Ω—å —á—ë—Ä–Ω—ã–π
        if self.root.color != Color.BLACK:
            print("‚ùå –°–≤–æ–π—Å—Ç–≤–æ 1: –ö–æ—Ä–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á—ë—Ä–Ω—ã–º")
            return False
        print("‚úì –°–≤–æ–π—Å—Ç–≤–æ 1: –ö–æ—Ä–µ–Ω—å —á—ë—Ä–Ω—ã–π")
        
        # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∞—Å–Ω—ã—Ö —É–∑–ª–æ–≤ –∏ —á—ë—Ä–Ω–æ–π –≤—ã—Å–æ—Ç—ã
        result, black_height = self._check_node(self.root)
        if result:
            print("‚úì –°–≤–æ–π—Å—Ç–≤–æ 2: –í—Å–µ –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–±–ª—é–¥–µ–Ω—ã")
            print(f"‚úì –ß—ë—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞: {black_height}")
            return True
        else:
            print("‚ùå –ö—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞—Ä—É—à–µ–Ω—ã")
            return False
    
    def _check_node(self, node: RBNode, black_count: int = 0) -> tuple:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∑–ª–∞ –∏ –ø–æ–¥—Å—á—ë—Ç —á—ë—Ä–Ω–æ–π –≤—ã—Å–æ—Ç—ã."""
        if node == self.NIL:
            return True, black_count
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞: –∫—Ä–∞—Å–Ω—ã–π —É–∑–µ–ª –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫—Ä–∞—Å–Ω—ã—Ö –¥–µ—Ç–µ–π
        if node.color == Color.RED:
            if node.left.color == Color.RED or node.right.color == Color.RED:
                return False, 0
        else:
            black_count += 1
        
        # –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤
        left_ok, left_height = self._check_node(node.left, black_count)
        right_ok, right_height = self._check_node(node.right, black_count)
        
        # –ß—ë—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π
        if not left_ok or not right_ok or left_height != right_height:
            return False, 0
        
        return True, left_height


# ============================================================================
# –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–û–ï –ú–ï–ù–Æ
# ============================================================================

def main():
    """–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –ø—Ä–æ–≥—Ä–∞–º–º—ã."""
    tree = RedBlackTree()
    
    print("=" * 60)
    print("–ö–†–ê–°–ù–û-–ß–Å–†–ù–û–ï –î–ï–†–ï–í–û ‚Äî –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞")
    print("=" * 60)
    
    while True:
        print("\nüìã –ú–ï–ù–Æ:")
        print("1. –í—Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç")
        print("2. –£–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç")
        print("3. –ù–∞–π—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç")
        print("4. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–µ—Ä–µ–≤–æ")
        print("5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—Ä–∞—Å–Ω–æ-—á—ë—Ä–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞")
        print("6. –°–æ–∑–¥–∞—Ç—å –¥–µ—Ä–µ–≤–æ –∏–∑ —Å–ø–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤")
        print("0. –í—ã—Ö–æ–¥")
        
        choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()
        
        if choice == "1":
            try:
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏: "))
                tree.insert(value)
                print(f"‚úì –≠–ª–µ–º–µ–Ω—Ç {value} –≤—Å—Ç–∞–≤–ª–µ–Ω")
                tree.display()
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ")
        
        elif choice == "2":
            try:
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "))
                tree.delete(value)
                print(f"‚úì –≠–ª–µ–º–µ–Ω—Ç {value} —É–¥–∞–ª—ë–Ω (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª)")
                tree.display()
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ")
        
        elif choice == "3":
            try:
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞: "))
                if tree.search(value):
                    print(f"‚úì –≠–ª–µ–º–µ–Ω—Ç {value} –Ω–∞–π–¥–µ–Ω –≤ –¥–µ—Ä–µ–≤–µ")
                else:
                    print(f"‚úó –≠–ª–µ–º–µ–Ω—Ç {value} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ")
        
        elif choice == "4":
            tree.display()
        
        elif choice == "5":
            tree.check_properties()
        
        elif choice == "6":
            input_str = input("–í–≤–µ–¥–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª: ")
            try:
                values = list(map(int, input_str.split()))
                tree = RedBlackTree()  # –ù–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ
                for value in values:
                    tree.insert(value)
                print(f"‚úì –°–æ–∑–¥–∞–Ω–æ –¥–µ—Ä–µ–≤–æ –∏–∑ {len(values)} —ç–ª–µ–º–µ–Ω—Ç–æ–≤")
                tree.display()
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª")
        
        elif choice == "0":
            print("\nüëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")


if __name__ == "__main__":
    main()
