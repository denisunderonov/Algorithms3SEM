
from hash_table import HashTable


def interactive_demo():
    """
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—ã.
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤–∏–¥–∏—Ç, –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Å—Ç–∞–≤–∫–∞ —Å –∫–æ–ª–ª–∏–∑–∏—è–º–∏.
    """
    print("=" * 60)
    print("–ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê–Ø –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –•–≠–®-–¢–ê–ë–õ–ò–¶–´ –° –ö–û–õ–õ–ò–ó–ò–Ø–ú–ò")
    print("=" * 60)
    
    # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã
    while True:
        try:
            size = int(input("\n–í–≤–µ–¥–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5 –∏–ª–∏ 7): "))
            if size > 0:
                break
            print("–†–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 0!")
        except ValueError:
            print("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
    
    ht = HashTable(size=size)
    print(f"\n‚úì –°–æ–∑–¥–∞–Ω–∞ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º {size}")
    print(f"  –•—ç—à-—Ñ—É–Ω–∫—Ü–∏—è: –∏–Ω–¥–µ–∫—Å = –∫–ª—é—á % {size}")
    print("\n" + "=" * 60)
    
    while True:
        print("\n" + "-" * 60)
        print("–¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –¢–ê–ë–õ–ò–¶–´:")
        ht.display()
        print("-" * 60)
        
        print("\n–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å?")
        print("  1 - –í—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ")
        print("  2 - –ù–∞–π—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ")
        print("  3 - –£–¥–∞–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ")
        print("  4 - –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–∞–∫–µ—Ç–∞")
        print("  0 - –í—ã—Ö–æ–¥")
        
        choice = input("\n–í–∞—à –≤—ã–±–æ—Ä: ").strip()
        
        if choice == "1":
            # –í—Å—Ç–∞–≤–∫–∞ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º
            try:
                value = int(input("\n–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏: "))
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –≤—Å—Ç–∞–≤–∫–∏ –ø–æ—à–∞–≥–æ–≤–æ
                hash_index = value % ht.size
                print(f"\nüìä –ü–†–û–¶–ï–°–° –í–°–¢–ê–í–ö–ò:")
                print(f"  1Ô∏è‚É£  –í—ã—á–∏—Å–ª—è–µ–º —Ö—ç—à: {value} % {ht.size} = {hash_index}")
                print(f"  2Ô∏è‚É£  –ò–¥–µ–º –≤ –±–∞–∫–µ—Ç ‚Ññ{hash_index}")
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —ç—Ç–æ–º –±–∞–∫–µ—Ç–µ
                current_bucket = ht.table[hash_index]
                if not current_bucket:
                    print(f"  3Ô∏è‚É£  –ë–∞–∫–µ—Ç –ø—É—Å—Ç–æ–π ‚Üí –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º {value}")
                else:
                    print(f"  3Ô∏è‚É£  –ë–∞–∫–µ—Ç –Ω–µ –ø—É—Å—Ç–æ–π! –¢–µ–∫—É—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã: {current_bucket}")
                    print(f"  4Ô∏è‚É£  ‚ö†Ô∏è  –ö–û–õ–õ–ò–ó–ò–Ø! –ù–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ø–∞–ª–∏ –≤ –æ–¥–∏–Ω –±–∞–∫–µ—Ç")
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                    if value in current_bucket:
                        print(f"  5Ô∏è‚É£  –ó–Ω–∞—á–µ–Ω–∏–µ {value} —É–∂–µ –µ—Å—Ç—å –≤ –±–∞–∫–µ—Ç–µ ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç –≤ –∫–æ–Ω–µ—Ü")
                    else:
                        print(f"  5Ô∏è‚É£  –ó–Ω–∞—á–µ–Ω–∏—è {value} –Ω–µ—Ç ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞")
                
                # –í—ã–ø–æ–ª–Ω—è–µ–º –≤—Å—Ç–∞–≤–∫—É
                bucket_idx, pos = ht.insert(value)
                print(f"\n  ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢: –í—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –±–∞–∫–µ—Ç {bucket_idx}, –ø–æ–∑–∏—Ü–∏—è {pos}")
                
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        
        elif choice == "2":
            # –ü–æ–∏—Å–∫
            try:
                value = int(input("\n–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –¥–ª—è –ø–æ–∏—Å–∫–∞: "))
                result = ht.search_by_value(value)
                
                hash_index = value % ht.size
                print(f"\nüîç –ü–†–û–¶–ï–°–° –ü–û–ò–°–ö–ê:")
                print(f"  1Ô∏è‚É£  –í—ã—á–∏—Å–ª—è–µ–º —Ö—ç—à: {value} % {ht.size} = {hash_index}")
                print(f"  2Ô∏è‚É£  –ò–¥–µ–º –≤ –±–∞–∫–µ—Ç ‚Ññ{hash_index}")
                print(f"  3Ô∏è‚É£  –ò—â–µ–º –∫–ª—é—á {value} –≤ —Å–ø–∏—Å–∫–µ...")
                
                if result:
                    print(f"\n  ‚úÖ –ù–ê–ô–î–ï–ù–û: {result}")
                else:
                    print(f"\n  ‚ùå –ù–ï –ù–ê–ô–î–ï–ù–û: –∫–ª—é—á {value} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        
        elif choice == "3":
            # –£–¥–∞–ª–µ–Ω–∏–µ
            try:
                value = int(input("\n–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "))
                
                hash_index = value % ht.size
                print(f"\nüóëÔ∏è  –ü–†–û–¶–ï–°–° –£–î–ê–õ–ï–ù–ò–Ø:")
                print(f"  1Ô∏è‚É£  –í—ã—á–∏—Å–ª—è–µ–º —Ö—ç—à: {value} % {ht.size} = {hash_index}")
                print(f"  2Ô∏è‚É£  –ò–¥–µ–º –≤ –±–∞–∫–µ—Ç ‚Ññ{hash_index}")
                print(f"  3Ô∏è‚É£  –ò—â–µ–º –∏ —É–¥–∞–ª—è–µ–º –ø–µ—Ä–≤–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–ª—é—á–∞ {value}...")
                
                result = ht.delete_by_value(value)
                if result:
                    print(f"\n  ‚úÖ –£–î–ê–õ–ï–ù–û: {result}")
                else:
                    print(f"\n  ‚ùå –ù–ï –ù–ê–ô–î–ï–ù–û: –∫–ª—é—á {value} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç")
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        
        elif choice == "4":
            # –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±–∞–∫–µ—Ç
            try:
                bucket_idx = int(input(f"\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –±–∞–∫–µ—Ç–∞ (0-{ht.size-1}): "))
                if 0 <= bucket_idx < ht.size:
                    bucket_content = ht.search_by_index(bucket_idx)
                    print(f"\nüì¶ –ë–ê–ö–ï–¢ ‚Ññ{bucket_idx}:")
                    if bucket_content:
                        print(f"  –≠–ª–µ–º–µ–Ω—Ç—ã: {bucket_content}")
                        print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(bucket_content)} (–∫–æ–ª–ª–∏–∑–∏–π: {len(bucket_content)-1})")
                    else:
                        print(f"  –ü—É—Å—Ç–æ")
                else:
                    print(f"‚ùå –û—à–∏–±–∫–∞: –Ω–æ–º–µ—Ä –±–∞–∫–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 0 –¥–æ {ht.size-1}")
            except ValueError:
                print("‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        
        elif choice == "0":
            print("\nüëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")


if __name__ == "__main__":
    interactive_demo()
