# -*- coding: utf-8 -*-
"""
–ü–ò–†–ê–ú–ò–î–´ (–ö–£–ß–ò) - Binary Heap
–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫—É—á–∞ —Å –ø–∏—Ä–∞–º–∏–¥–∞–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

–ü–∏—Ä–∞–º–∏–¥–∞ (–∫—É—á–∞) ‚Äî —ç—Ç–æ –¥–≤–æ–∏—á–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å –±–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ —Å–≤–æ–∏—Ö –¥–µ—Ç–µ–π.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∏–Ω–∏–º—É–º–∞/–º–∞–∫—Å–∏–º—É–º–∞ –∑–∞ O(1) –∏ –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –∑–∞ O(log n).
"""
import random  # –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è—Ö
import time    # –î–ª—è –∑–∞–º–µ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤


class BinaryHeap:
    """
    –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–≤–æ–∏—á–Ω–æ–π –ø–∏—Ä–∞–º–∏–¥–æ–π (binary heap).
    –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é (max-heap) –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é (min-heap) –∫—É—á—É.
    """
    
    def __init__(self, heap_type='max'):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∏—Ä–∞–º–∏–¥—ã.
        
        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
            heap_type (str): –¢–∏–ø –∫—É—á–∏ ‚Äî 'max' –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏–ª–∏ 'min' –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π
        """
        # –°–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫—É—á–∏
        self.heap = []
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∏–ø –∫—É—á–∏ (max –∏–ª–∏ min)
        self.heap_type = heap_type
    
    def compare(self, a, b):
        """
        –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–ª—è –æ–±–æ–∏—Ö —Ç–∏–ø–æ–≤ –∫—É—á.
        
        –î–ª—è max-heap: –ø—Ä–æ–≤–µ—Ä—è–µ–º, –±–æ–ª—å—à–µ –ª–∏ a, —á–µ–º b (—Ä–æ–¥–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ –¥–µ—Ç–µ–π)
        –î–ª—è min-heap: –ø—Ä–æ–≤–µ—Ä—è–µ–º, –º–µ–Ω—å—à–µ –ª–∏ a, —á–µ–º b (—Ä–æ–¥–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ –¥–µ—Ç–µ–π)
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç a –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã—à–µ —ç–ª–µ–º–µ–Ω—Ç–∞ b –≤ –∫—É—á–µ
        """
        if self.heap_type == 'max':
            # –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∫—É—á–∏: –±–æ–ª—å—à–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–≤–µ—Ä—Ö—É
            return a > b
        else:
            # –î–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∫—É—á–∏: –º–µ–Ω—å—à–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–≤–µ—Ä—Ö—É
            return a < b
    
    def parent(self, i):
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º i.
        
        –§–æ—Ä–º—É–ª–∞: parent = (i - 1) // 2
        –ü—Ä–∏–º–µ—Ä: –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º 5, —Ä–æ–¥–∏—Ç–µ–ª—å –±—É–¥–µ—Ç (5-1)//2 = 2
        """
        return (i - 1) // 2
    
    def left_child(self, i):
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º i.
        
        –§–æ—Ä–º—É–ª–∞: left_child = 2 * i + 1
        –ü—Ä–∏–º–µ—Ä: –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º 2, –ª–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –±—É–¥–µ—Ç 2*2+1 = 5
        """
        return 2 * i + 1
    
    def right_child(self, i):
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º i.
        
        –§–æ—Ä–º—É–ª–∞: right_child = 2 * i + 2
        –ü—Ä–∏–º–µ—Ä: –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º 2, –ø—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –±—É–¥–µ—Ç 2*2+2 = 6
        """
        return 2 * i + 2
    
    def sift_up(self, i):
        """
        –ü—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ –≤–≤–µ—Ä—Ö (sift up / bubble up).
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞.
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ë–µ—Ä—ë–º —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ i
        2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –µ–≥–æ —Å —Ä–æ–¥–∏—Ç–µ–ª–µ–º
        3. –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç "–ª—É—á—à–µ" —Ä–æ–¥–∏—Ç–µ–ª—è (–±–æ–ª—å—à–µ –¥–ª—è max-heap, –º–µ–Ω—å—à–µ –¥–ª—è min-heap),
           —Ç–æ –º–µ–Ω—è–µ–º –∏—Ö –º–µ—Å—Ç–∞–º–∏
        4. –ü–æ–≤—Ç–æ—Ä—è–µ–º, –ø–æ–∫–∞ –Ω–µ –¥–æ–π–¥—ë–º –¥–æ –∫–æ—Ä–Ω—è –∏–ª–∏ –Ω–µ –Ω–∞–π–¥—ë–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n), –≥–¥–µ n ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫—É—á–µ
        """
        # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ –∫–æ—Ä–Ω—è (–∏–Ω–¥–µ–∫—Å 0)
        while i > 0:
            # –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å —Ä–æ–¥–∏—Ç–µ–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
            parent_idx = self.parent(i)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º: –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–º–µ–Ω—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Å —Ä–æ–¥–∏—Ç–µ–ª–µ–º?
            # (–¥–ª—è max-heap: –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –±–æ–ª—å—à–µ —Ä–æ–¥–∏—Ç–µ–ª—è, –¥–ª—è min-heap: –µ—Å–ª–∏ –º–µ–Ω—å—à–µ)
            if self.compare(self.heap[i], self.heap[parent_idx]):
                # –î–∞, –Ω—É–∂–Ω–æ! –ú–µ–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –º–µ—Å—Ç–∞–º–∏ —Å —Ä–æ–¥–∏—Ç–µ–ª–µ–º
                self.heap[i], self.heap[parent_idx] = self.heap[parent_idx], self.heap[i]
                # –¢–µ–ø–µ—Ä—å —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –≤—ã—à–µ
                i = parent_idx
            else:
                # –≠–ª–µ–º–µ–Ω—Ç –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ, —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
                break
    
    def sift_down(self, i):
        """
        –ü—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ –≤–Ω–∏–∑ (sift down / heapify down).
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ—Ä–Ω—è –∏–ª–∏ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –∫—É—á–∏.
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ë–µ—Ä—ë–º —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ i
        2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –µ–≥–æ —Å –æ–±–æ–∏–º–∏ –¥–µ—Ç—å–º–∏ (–ª–µ–≤—ã–º –∏ –ø—Ä–∞–≤—ã–º)
        3. –ù–∞—Ö–æ–¥–∏–º "–ª—É—á—à–µ–≥–æ" –∏–∑ —Ç—Ä—ë—Ö (—Ä–æ–¥–∏—Ç–µ–ª—å –∏ –¥–≤–∞ —Ä–µ–±—ë–Ω–∫–∞)
        4. –ï—Å–ª–∏ –ª—É—á—à–∏–π ‚Äî –æ–¥–∏–Ω –∏–∑ –¥–µ—Ç–µ–π, –º–µ–Ω—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è —Å —ç—Ç–∏–º —Ä–µ–±—ë–Ω–∫–æ–º
        5. –ü–æ–≤—Ç–æ—Ä—è–µ–º –¥–ª—è –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, –ø–æ–∫–∞ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –æ–∫–∞–∂–µ—Ç—Å—è –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n)
        """
        # –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫—É—á–µ
        n = len(self.heap)
        
        # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ, –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ–º –ª–∏—Å—Ç—å–µ–≤ –¥–µ—Ä–µ–≤–∞
        while True:
            # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî –ª—É—á—à–∏–π (—Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –¥–ª—è max-heap)
            best = i
            
            # –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ –¥–µ—Ç–µ–π
            left = self.left_child(i)
            right = self.right_child(i)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–µ–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞:
            # –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω (left < n) –∏ –ª—É—á—à–µ –ª–∏ –æ–Ω —Ç–µ–∫—É—â–µ–≥–æ –ª—É—á—à–µ–≥–æ?
            if left < n and self.compare(self.heap[left], self.heap[best]):
                # –î–∞! –õ–µ–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –ª—É—á—à–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å –ª—É—á—à–µ–≥–æ
                best = left
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞:
            # –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω –∏ –ª—É—á—à–µ –ª–∏ –æ–Ω —Ç–µ–∫—É—â–µ–≥–æ –ª—É—á—à–µ–≥–æ?
            if right < n and self.compare(self.heap[right], self.heap[best]):
                # –î–∞! –ü—Ä–∞–≤—ã–π —Ä–µ–±—ë–Ω–æ–∫ –ª—É—á—à–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å –ª—É—á—à–µ–≥–æ
                best = right
            
            # –ï—Å–ª–∏ –ª—É—á—à–∏–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî –Ω–µ —Ç–µ–∫—É—â–∏–π, –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏
            if best != i:
                # –ú–µ–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å –ª—É—á—à–∏–º —Ä–µ–±—ë–Ω–∫–æ–º
                self.heap[i], self.heap[best] = self.heap[best], self.heap[i]
                # –¢–µ–ø–µ—Ä—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ —Å –ø–æ–∑–∏—Ü–∏–∏, –∫—É–¥–∞ –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç
                i = best
            else:
                # –¢–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –æ–∫–∞–∑–∞–ª—Å—è –ª—É—á—à–µ –æ–±–æ–∏—Ö –¥–µ—Ç–µ–π ‚Äî –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ, –≤—ã—Ö–æ–¥–∏–º
                break
    
    def insert(self, value):
        """
        –í—Å—Ç–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫—É—á—É.
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞ (—ç—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏)
        2. –í—ã–∑—ã–≤–∞–µ–º sift_up, —á—Ç–æ–±—ã "–≤—Å–ø–ª—ã—Ç—å" —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n)
        
        –ü—Ä–∏–º–µ—Ä: –≤—Å—Ç–∞–≤–∫–∞ 15 –≤ max-heap [20, 10, 8]
        –®–∞–≥ 1: [20, 10, 8, 15] ‚Äî –¥–æ–±–∞–≤–∏–ª–∏ –≤ –∫–æ–Ω–µ—Ü
        –®–∞–≥ 2: sift_up –ø–æ–¥–Ω–∏–º–µ—Ç 15 –≤—ã—à–µ 10 ‚Üí [20, 15, 8, 10]
        """
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–∞–º—ã–π –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞ (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–∏—Å—Ç–æ–º –¥–µ—Ä–µ–≤–∞)
        self.heap.append(value)
        # –ü—Ä–æ—Å–µ–∏–≤–∞–µ–º –µ–≥–æ –≤–≤–µ—Ä—Ö, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏
        self.sift_up(len(self.heap) - 1)
        # –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –≤—Å—Ç–∞–≤–∫–µ
        print(f"‚úÖ –í—Å—Ç–∞–≤–ª–µ–Ω —ç–ª–µ–º–µ–Ω—Ç: {value}")
    
    def extract_root(self):
        """
        –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è –∫—É—á–∏ (—É–¥–∞–ª–µ–Ω–∏–µ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏—è).
        –î–ª—è max-heap: –∏–∑–≤–ª–µ–∫–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        –î–ª—è min-heap: –∏–∑–≤–ª–µ–∫–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è (–ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞)
        2. –ó–∞–º–µ–Ω—è–µ–º –∫–æ—Ä–µ–Ω—å –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–∞—Å—Å–∏–≤–∞
        3. –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç
        4. –ü—Ä–æ—Å–µ–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å –≤–Ω–∏–∑, —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log n)
        
        –ü—Ä–∏–º–µ—Ä: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ max-heap [20, 15, 8, 10]
        –®–∞–≥ 1: –ë–µ—Ä—ë–º –∫–æ—Ä–µ–Ω—å 20
        –®–∞–≥ 2: –°—Ç–∞–≤–∏–º –Ω–∞ –µ–≥–æ –º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç 10 ‚Üí [10, 15, 8]
        –®–∞–≥ 3: sift_down –æ–ø—É—Å—Ç–∏—Ç 10 –Ω–∏–∂–µ 15 ‚Üí [15, 10, 8]
        –í–æ–∑–≤—Ä–∞—â–∞–µ–º: 20
        """
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º: –∞ –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∫—É—á–µ?
        if not self.heap:
            print("‚ö†Ô∏è  –ö—É—á–∞ –ø—É—Å—Ç–∞—è!")
            return None
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ –º—ã –≤–µ—Ä–Ω—ë–º
        root = self.heap[0]
        
        # –ë–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –∏ —Å—Ç–∞–≤–∏–º –µ–≥–æ –Ω–∞ –º–µ—Å—Ç–æ –∫–æ—Ä–Ω—è
        self.heap[0] = self.heap[-1]
        # –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç (–æ–Ω —Ç–µ–ø–µ—Ä—å –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ)
        self.heap.pop()
        
        # –ï—Å–ª–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∫—É—á–∞ –Ω–µ –ø—É—Å—Ç–∞—è, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏
        if self.heap:
            # –ü—Ä–æ—Å–µ–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å –≤–Ω–∏–∑ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ
            self.sift_down(0)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–π –∫–æ—Ä–µ–Ω—å
        return root
    
    def peek(self):
        """
        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ä–Ω—è –∫—É—á–∏ –±–µ–∑ –µ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.
        –î–ª—è max-heap: —Å–º–æ—Ç—Ä–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        –î–ª—è min-heap: —Å–º–æ—Ç—Ä–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(1) ‚Äî –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
        """
        # –ï—Å–ª–∏ –∫—É—á–∞ –ø—É—Å—Ç–∞—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
        if not self.heap:
            return None
        # –ö–æ—Ä–µ–Ω—å –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –º–∞—Å—Å–∏–≤–∞ (–∏–Ω–¥–µ–∫—Å 0)
        return self.heap[0]
    
    def search(self, value):
        """
        –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫—É—á–µ.
        –í–∞–∂–Ω–æ: –≤ –∫—É—á–µ –Ω–µ—Ç –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞! –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã.
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) ‚Äî –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–ª–∏ -1, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
        """
        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
            index = self.heap.index(value)
            # –≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ –∏–Ω–¥–µ–∫—Å
            return index
        except ValueError:
            # –≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º -1
            return -1
    
    def delete(self, value):
        """
        –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –∫—É—á–∏ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è).
        
        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ –∫—É—á–µ (–ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫)
        2. –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ ‚Äî –≤—ã—Ö–æ–¥–∏–º —Å –æ—à–∏–±–∫–æ–π
        3. –ó–∞–º–µ–Ω—è–µ–º —É–¥–∞–ª—è–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–∞—Å—Å–∏–≤–∞
        4. –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç
        5. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏: –ª–∏–±–æ –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö, –ª–∏–±–æ –≤–Ω–∏–∑
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) –Ω–∞ –ø–æ–∏—Å–∫ + O(log n) –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ = O(n)
        """
        # –®–∞–≥ 1: –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ –∫—É—á–µ
        index = self.search(value)
        
        # –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–æ–±—â–∞–µ–º –æ–± –æ—à–∏–±–∫–µ
        if index == -1:
            print(f"‚ùå –≠–ª–µ–º–µ–Ω—Ç {value} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            return False
        
        # –®–∞–≥ 2: –ó–∞–º–µ–Ω—è–µ–º —É–¥–∞–ª—è–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
        self.heap[index] = self.heap[-1]
        # –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç (–æ–Ω —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω –Ω–∞ –º–µ—Å—Ç–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ)
        self.heap.pop()
        
        # –®–∞–≥ 3: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–≤–æ–π—Å—Ç–≤–æ –∫—É—á–∏
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ—Å—Ç–∞–ª–∏—Å—å –ª–∏ –µ—â—ë —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –Ω–µ —É–¥–∞–ª–∏–ª–∏ –ª–∏ –º—ã –ø–æ—Å–ª–µ–¥–Ω–∏–π
        if index < len(self.heap):
            # –ù–∞—Ö–æ–¥–∏–º —Ä–æ–¥–∏—Ç–µ–ª—è –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏
            parent_idx = self.parent(index)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º: –Ω—É–∂–Ω–æ –ª–∏ –ø—Ä–æ—Å–µ—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤–≤–µ—Ä—Ö?
            # (–µ—Å–ª–∏ –æ–Ω –ª—É—á—à–µ —Ä–æ–¥–∏—Ç–µ–ª—è)
            if index > 0 and self.compare(self.heap[index], self.heap[parent_idx]):
                # –î–∞, –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö
                self.sift_up(index)
            else:
                # –ù–µ—Ç, –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–Ω–∏–∑
                self.sift_down(index)
        
        # –°–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—à–Ω–æ–º —É–¥–∞–ª–µ–Ω–∏–∏
        print(f"‚úÖ –£–¥–∞–ª—ë–Ω —ç–ª–µ–º–µ–Ω—Ç: {value}")
        return True
    
    def build_heap(self, array):
        """
        –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—É—á–∏ –∏–∑ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ (heapify).
        –≠—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å –∫—É—á—É –∑–∞ O(n), –∞ –Ω–µ –∑–∞ O(n log n).
        
        –ê–ª–≥–æ—Ä–∏—Ç–º (–º–µ—Ç–æ–¥ –§–ª–æ–π–¥–∞):
        1. –ö–æ–ø–∏—Ä—É–µ–º –≤–µ—Å—å –º–∞—Å—Å–∏–≤ –≤ –∫—É—á—É "–∫–∞–∫ –µ—Å—Ç—å"
        2. –ù–∞—á–∏–Ω–∞–µ–º —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É–∑–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –¥–µ—Ç–µ–π (–Ω–µ –ª–∏—Å—Ç)
        3. –ò–¥—ë–º –æ—Ç —ç—Ç–æ–≥–æ —É–∑–ª–∞ –∫ –∫–æ—Ä–Ω—é, –ø—Ä–∏–º–µ–Ω—è—è sift_down –∫ –∫–∞–∂–¥–æ–º—É
        4. –í –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∞–µ–º –≤–∞–ª–∏–¥–Ω—É—é –∫—É—á—É
        
        –ü–æ—á–µ–º—É O(n), –∞ –Ω–µ O(n log n)?
        - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–Ω–∏–∑—É –¥–µ—Ä–µ–≤–∞ (–ª–∏—Å—Ç—å—è)
        - –õ–∏—Å—Ç—å—è –≤–æ–æ–±—â–µ –Ω–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å (—É –Ω–∏—Ö –Ω–µ—Ç –¥–µ—Ç–µ–π)
        - –ß–µ–º –±–ª–∏–∂–µ –∫ –∫–æ—Ä–Ω—é, —Ç–µ–º –±–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã, –Ω–æ —Ç–∞–∫–∏—Ö —É–∑–ª–æ–≤ –º–∞–ª–æ
        
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) ‚Äî –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è!
        
        –ü—Ä–∏–º–µ—Ä: [4, 10, 3, 5, 1] ‚Üí max-heap
        –ù–∞—á–∏–Ω–∞–µ–º —Å –∏–Ω–¥–µ–∫—Å–∞ (5//2 - 1) = 1 (—ç–ª–µ–º–µ–Ω—Ç 10)
        –ü—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–Ω–∏–∑: 10, –∑–∞—Ç–µ–º 4
        –†–µ–∑—É–ª—å—Ç–∞—Ç: [10, 5, 3, 4, 1]
        """
        # –ö–æ–ø–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –≤ –Ω–∞—à—É –∫—É—á—É (–Ω–µ –∏–∑–º–µ–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤)
        self.heap = array.copy()
        
        # –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–µ-–ª–∏—Å—Ç–∞
        # –§–æ—Ä–º—É–ª–∞: (n // 2 - 1), –≥–¥–µ n ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        # –õ–∏—Å—Ç—å—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å –∏–Ω–¥–µ–∫—Å–∞ n//2 –¥–æ –∫–æ–Ω—Ü–∞, –∏—Ö –Ω–µ —Ç—Ä–æ–≥–∞–µ–º
        last_non_leaf = len(self.heap) // 2 - 1
        
        # –ü—Ä–æ—Ö–æ–¥–∏–º –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–µ-–ª–∏—Å—Ç–∞ –¥–æ –∫–æ—Ä–Ω—è (–≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ)
        for i in range(last_non_leaf, -1, -1):
            # –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º –ø—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ –≤–Ω–∏–∑
            # –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø–æ–¥–¥–µ—Ä–µ–≤–æ —Å –∫–æ—Ä–Ω–µ–º i —Å—Ç–∞–Ω–µ—Ç –≤–∞–ª–∏–¥–Ω–æ–π –∫—É—á–µ–π
            self.sift_down(i)
        
        # –°–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—à–Ω–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –∫—É—á–∏
        print(f"‚úÖ –ö—É—á–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞: {array}")
    
    def is_empty(self):
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—É—Å—Ç–∞ –ª–∏ –∫—É—á–∞?
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ –≤ –∫—É—á–µ –Ω–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∏–Ω–∞—á–µ False
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(1)
        """
        return len(self.heap) == 0
    
    def size(self):
        """
        –£–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫—É—á–µ.
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ ‚Äî —Ä–∞–∑–º–µ—Ä –∫—É—á–∏
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(1)
        """
        return len(self.heap)
    
    def get_array(self):
        """
        –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ø–∏—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∫—É—á–∏.
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ø–∏—é (–Ω–µ –æ—Ä–∏–≥–∏–Ω–∞–ª), —á—Ç–æ–±—ã –≤–Ω–µ—à–Ω–∏–π –∫–æ–¥ –Ω–µ –º–æ–≥ –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –∫—É—á—É
        –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(n) ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –∫–æ–ø–∏—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        """
        return self.heap.copy()

    # ========== –ê–ª–∏–∞—Å—ã –∏ –ø–∏—Ç–æ–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è) ==========
    
    def push(self, value):
        """
        –ê–ª–∏–∞—Å –¥–ª—è –º–µ—Ç–æ–¥–∞ insert().
        –ë–æ–ª–µ–µ –ø—Ä–∏–≤—ã—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ (–∫–∞–∫ –≤ —Å—Ç–µ–∫–µ/–æ—á–µ—Ä–µ–¥–∏).
        
        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: heap.push(10) –≤–º–µ—Å—Ç–æ heap.insert(10)
        """
        return self.insert(value)

    def pop(self):
        """
        –ê–ª–∏–∞—Å –¥–ª—è –º–µ—Ç–æ–¥–∞ extract_root().
        –ë–æ–ª–µ–µ –ø—Ä–∏–≤—ã—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ—Ä–Ω—è (–∫–∞–∫ –≤ —Å—Ç–µ–∫–µ/–æ—á–µ—Ä–µ–¥–∏).
        
        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: value = heap.pop() –≤–º–µ—Å—Ç–æ value = heap.extract_root()
        """
        return self.extract_root()

    def __len__(self):
        """
        –ú–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ len(heap).
        –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å: n = len(heap) –≤–º–µ—Å—Ç–æ n = heap.size()
        """
        return len(self.heap)

    def __bool__(self):
        """
        –ú–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ if heap: ...
        –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å: if heap: ... –≤–º–µ—Å—Ç–æ if not heap.is_empty(): ...
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ –∫—É—á–∞ –Ω–µ –ø—É—Å—Ç–∞—è
        """
        return not self.is_empty()

    def __repr__(self):
        """
        –ú–∞–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ –æ–±—ä–µ–∫—Ç–∞ –∫—É—á–∏.
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ print(heap) –∏ –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ.
        
        –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞: BinaryHeap(type=max, heap=[10, 5, 3])
        """
        return f"BinaryHeap(type={self.heap_type}, heap={self.heap})"


class MaxHeap(BinaryHeap):
    """
    –£–¥–æ–±–Ω—ã–π –∫–ª–∞—Å—Å-–æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∫—É—á–∏.
    –ù–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã –æ—Ç BinaryHeap, –Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç max-heap.
    
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
        heap = MaxHeap()  # –≤–º–µ—Å—Ç–æ heap = BinaryHeap('max')
        heap.push(10)
        print(heap.pop())  # –≤—ã–≤–µ–¥–µ—Ç –º–∞–∫—Å–∏–º—É–º
    """
    def __init__(self):
        # –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å —Ç–∏–ø–æ–º 'max'
        super().__init__(heap_type='max')


class MinHeap(BinaryHeap):
    """
    –£–¥–æ–±–Ω—ã–π –∫–ª–∞—Å—Å-–æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∫—É—á–∏.
    –ù–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã –æ—Ç BinaryHeap, –Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç min-heap.
    
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
        heap = MinHeap()  # –≤–º–µ—Å—Ç–æ heap = BinaryHeap('min')
        heap.push(10)
        print(heap.pop())  # –≤—ã–≤–µ–¥–µ—Ç –º–∏–Ω–∏–º—É–º
    """
    def __init__(self):
        # –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å —Ç–∏–ø–æ–º 'min'
        super().__init__(heap_type='min')


def heap_sort(array, reverse=False):
    """
    –ü–∏—Ä–∞–º–∏–¥–∞–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    reverse=False: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é (–∏—Å–ø–æ–ª—å–∑—É–µ–º max-heap)
    reverse=True: –ø–æ —É–±—ã–≤–∞–Ω–∏—é (–∏—Å–ø–æ–ª—å–∑—É–µ–º min-heap)
    """
    start_time = time.time()
    
    # –°–æ–∑–¥–∞—ë–º –∫—É—á—É
    heap_type = 'max' if not reverse else 'min'
    heap = BinaryHeap(heap_type)
    heap.build_heap(array)
    
    sorted_array = []
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –∫—É—á–∏
    while not heap.is_empty():
        sorted_array.append(heap.extract_root())
    
    end_time = time.time()
    execution_time = (end_time - start_time) * 1000  # –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
    
    return sorted_array, execution_time


def display_heap_tree(heap_obj, index=0, indent="", last=True):
    """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—É—á–∏ –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞"""
    if index >= len(heap_obj.heap):
        return
    
    array = heap_obj.heap
    
    # –ü—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
    right_idx = heap_obj.right_child(index)
    if right_idx < len(array):
        display_heap_tree(heap_obj, right_idx, indent + ("     " if last else " ‚îÇ   "), False)
    
    # –¢–µ–∫—É—â–∏–π —É–∑–µ–ª
    if index == 0:
        print(array[index])
    else:
        print(indent + (" ‚îî‚îÄ‚îÄ " if last else " ‚îå‚îÄ‚îÄ ") + str(array[index]))
    
    # –õ–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
    left_idx = heap_obj.left_child(index)
    if left_idx < len(array):
        display_heap_tree(heap_obj, left_idx, indent + (" ‚îÇ   " if last else "     "), True)


def display_heap(heap_obj):
    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—á–∏"""
    if heap_obj.is_empty():
        print("\n" + "="*50)
        print("–ö—É—á–∞ –ø—É—Å—Ç–∞—è")
        print("="*50 + "\n")
        return
    
    heap_type_name = "–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø" if heap_obj.heap_type == 'max' else "–ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø"
    print("\n" + "="*50)
    print(f"{heap_type_name} –ö–£–ß–ê:")
    print("="*50)
    print(f"–ú–∞—Å—Å–∏–≤: {heap_obj.heap}")
    print(f"–†–∞–∑–º–µ—Ä: {heap_obj.size()}")
    print(f"–ö–æ—Ä–µ–Ω—å: {heap_obj.peek()}")
    print("\n–î–µ—Ä–µ–≤–æ:")
    display_heap_tree(heap_obj)
    print("="*50 + "\n")


def print_menu():
    """–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    print("\n" + "‚ïî" + "="*58 + "‚ïó")
    print("‚ïë" + " "*20 + "üî∫ –ü–ò–†–ê–ú–ò–î–´ (–ö–£–ß–ò) üî∫" + " "*18 + "‚ïë")
    print("‚ïö" + "="*58 + "‚ïù")
    print("\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
    print("‚îÇ  –°–û–ó–î–ê–ù–ò–ï –ö–£–ß–ò:                                         ‚îÇ")
    print("‚îÇ  1.  –°–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∫—É—á—É (max-heap)               ‚îÇ")
    print("‚îÇ  2.  –°–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∫—É—á—É (min-heap)                ‚îÇ")
    print("‚îÇ  3.  –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—É—á—É –∏–∑ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞               ‚îÇ")
    print("‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print("‚îÇ  –û–ü–ï–†–ê–¶–ò–ò:                                              ‚îÇ")
    print("‚îÇ  4.  –í—Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç                                   ‚îÇ")
    print("‚îÇ  5.  –£–¥–∞–ª–∏—Ç—å –∫–æ—Ä–µ–Ω—å (extract max/min)                   ‚îÇ")
    print("‚îÇ  6.  –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç                         ‚îÇ")
    print("‚îÇ  7.  –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–∞                                     ‚îÇ")
    print("‚îÇ  8.  –ü–æ–∫–∞–∑–∞—Ç—å –∫—É—á—É                                      ‚îÇ")
    print("‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print("‚îÇ  –ü–ò–†–ê–ú–ò–î–ê–õ–¨–ù–ê–Ø –°–û–†–¢–ò–†–û–í–ö–ê:                              ‚îÇ")
    print("‚îÇ  9.  –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é)                ‚îÇ")
    print("‚îÇ  10. –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)                   ‚îÇ")
    print("‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print("‚îÇ  0.  –í—ã—Ö–æ–¥                                              ‚îÇ")
    print("‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")


def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    heap = None
    
    print("\n" + "üî∫"*30)
    print("  –ü–†–û–ì–†–ê–ú–ú–ê –†–ê–ë–û–¢–´ –° –ü–ò–†–ê–ú–ò–î–ê–ú–ò (–ö–£–ß–ê–ú–ò)")
    print("üî∫"*30)
    
    print("\nüìö –ö–†–ê–¢–ö–ê–Ø –¢–ï–û–†–ò–Ø:")
    print("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ")
    print("–ü–ò–†–ê–ú–ò–î–ê (–ö–£–ß–ê) - —ç—Ç–æ –¥–≤–æ–∏—á–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –≥–¥–µ:")
    print("‚Ä¢ MAX-HEAP: —Ä–æ–¥–∏—Ç–µ–ª—å ‚â• –¥–µ—Ç–µ–π (–∫–æ—Ä–µ–Ω—å - –º–∞–∫—Å–∏–º—É–º)")
    print("‚Ä¢ MIN-HEAP: —Ä–æ–¥–∏—Ç–µ–ª—å ‚â§ –¥–µ—Ç–µ–π (–∫–æ—Ä–µ–Ω—å - –º–∏–Ω–∏–º—É–º)")
    print("\n–û–°–ù–û–í–ù–´–ï –û–ü–ï–†–ê–¶–ò–ò:")
    print("‚Ä¢ –í—Å—Ç–∞–≤–∫–∞: O(log n) - –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü, –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö")
    print("‚Ä¢ –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è: O(log n) - –∑–∞–º–µ–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–º, –ø—Ä–æ—Å–µ–∏–≤–∞–µ–º –≤–Ω–∏–∑")
    print("‚Ä¢ Heapify: O(n) - –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –≤ –∫—É—á—É")
    print("‚Ä¢ Heap Sort: O(n log n) - —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –∫—É—á—É")
    print("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n")
    
    while True:
        print_menu()
        choice = input("\n‚û§ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()
        
        try:
            if choice == '1':
                # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫—É—á–∞
                heap = BinaryHeap('max')
                print("\n‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –∫—É—á–∞ (max-heap)")
                print("   –°–≤–æ–π—Å—Ç–≤–æ: —Ä–æ–¥–∏—Ç–µ–ª—å ‚â• –¥–µ—Ç–µ–π, –∫–æ—Ä–µ–Ω—å - –º–∞–∫—Å–∏–º—É–º")
                display_heap(heap)
            
            elif choice == '2':
                # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫—É—á–∞
                heap = BinaryHeap('min')
                print("\n‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø –∫—É—á–∞ (min-heap)")
                print("   –°–≤–æ–π—Å—Ç–≤–æ: —Ä–æ–¥–∏—Ç–µ–ª—å ‚â§ –¥–µ—Ç–µ–π, –∫–æ—Ä–µ–Ω—å - –º–∏–Ω–∏–º—É–º")
                display_heap(heap)
            
            elif choice == '3':
                # –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–∑ –º–∞—Å—Å–∏–≤–∞
                if heap is None:
                    print("\n‚ö†Ô∏è  –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫—É—á—É (–≤—ã–±–µ—Ä–∏—Ç–µ 1 –∏–ª–∏ 2)!")
                    continue
                
                size = int(input("–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: "))
                array = [random.randint(1, 100) for _ in range(size)]
                print(f"\nüìä –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤: {array}")
                
                heap.build_heap(array)
                display_heap(heap)
            
            elif choice == '4':
                # –í—Å—Ç–∞–≤–∫–∞
                if heap is None:
                    print("\n‚ö†Ô∏è  –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∫—É—á—É!")
                    continue
                
                display_heap(heap)
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏: "))
                heap.insert(value)
                display_heap(heap)
            
            elif choice == '5':
                # –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è
                if heap is None or heap.is_empty():
                    print("\n‚ö†Ô∏è  –ö—É—á–∞ –ø—É—Å—Ç–∞—è!")
                    continue
                
                display_heap(heap)
                root_name = "–º–∞–∫—Å–∏–º—É–º" if heap.heap_type == 'max' else "–º–∏–Ω–∏–º—É–º"
                root = heap.extract_root()
                print(f"\n‚úÖ –£–¥–∞–ª—ë–Ω –∫–æ—Ä–µ–Ω—å ({root_name}): {root}")
                display_heap(heap)
            
            elif choice == '6':
                # –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
                if heap is None or heap.is_empty():
                    print("\n‚ö†Ô∏è  –ö—É—á–∞ –ø—É—Å—Ç–∞—è!")
                    continue
                
                display_heap(heap)
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "))
                heap.delete(value)
                display_heap(heap)
            
            elif choice == '7':
                # –ü–æ–∏—Å–∫
                if heap is None or heap.is_empty():
                    print("\n‚ö†Ô∏è  –ö—É—á–∞ –ø—É—Å—Ç–∞—è!")
                    continue
                
                value = int(input("–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞: "))
                index = heap.search(value)
                
                if index != -1:
                    print(f"\n‚úÖ –≠–ª–µ–º–µ–Ω—Ç {value} –Ω–∞–π–¥–µ–Ω –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ {index}")
                    print(f"   –ú–∞—Å—Å–∏–≤: {heap.heap}")
                else:
                    print(f"\n‚ùå –≠–ª–µ–º–µ–Ω—Ç {value} –Ω–µ –Ω–∞–π–¥–µ–Ω")
            
            elif choice == '8':
                # –ü–æ–∫–∞–∑–∞—Ç—å –∫—É—á—É
                if heap is None:
                    print("\n‚ö†Ô∏è  –ö—É—á–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞!")
                    continue
                display_heap(heap)
            
            elif choice == '9':
                # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
                size = int(input("–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: "))
                array = [random.randint(1, 100) for _ in range(size)]
                
                print(f"\nüìä –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {array}")
                sorted_array, exec_time = heap_sort(array, reverse=False)
                print(f"\n‚úÖ –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (‚Üë): {sorted_array}")
                print(f"‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {exec_time:.4f} –º—Å")
            
            elif choice == '10':
                # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é
                size = int(input("–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: "))
                array = [random.randint(1, 100) for _ in range(size)]
                
                print(f"\nüìä –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {array}")
                sorted_array, exec_time = heap_sort(array, reverse=True)
                print(f"\n‚úÖ –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (‚Üì): {sorted_array}")
                print(f"‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {exec_time:.4f} –º—Å")
            
            elif choice == '0':
                print("\nüëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!\n")
                break
            
            else:
                print("\n‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!")
        
        except ValueError:
            print("\n‚ùå –û—à–∏–±–∫–∞: –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ!")
        except KeyboardInterrupt:
            print("\n\nüëã –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞. –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!\n")
            break
        except Exception as e:
            print(f"\n‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")


if __name__ == "__main__":
    main()
